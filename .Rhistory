geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = ""), nrow=1, ncol=2)
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+theme(axis.text=element_text(size=24))+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4)),
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4)),
#+theme(axis.text=element_text(size=24))
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = ""), nrow=1, ncol=2)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = ""), nrow=1, ncol=2)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24)), nrow=1, ncol=2)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24)), nrow=1, ncol=2)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
pdf("six.marg.rwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
pdf("six.marg.rwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
pdf("six.marg.rwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
getwd()
setwd('~/Box/adhya/gabesana/geomcmc/codes/sixmode/')
getwd()
pdf("six.marg.rwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
log.w_den <- function(x,z){
if(abs(x)>10){
return(-Inf)
}else{
return(-x^2 +x*csc(z)^5)
}
}
#log of full Cond of z (x) given w
log.z_den <- function(x,w){
if(abs(x)>10){
return(-Inf)
}else{
return(-0.5*csc(x)^10 +w*csc(x)^5)
}
}
mean.base = function(x) x
var.base = function(x) 0.01
dens.base=function(y,x) dnorm(y, mean=x,sd=0.1)
samp.base=function(x) x+0.1*rnorm(1)
mean.ap.tar=function(x) 0
var.ap.tar=function(x) 30^2
sq.x=30
dens.ap.tar=function(y,x) dnorm(y,sd=sq.x)
samp.ap.tar=function(x,kk=1) sq.x*rnorm(1)
geomc.gibbs<-function(initial,n.iter){
samp=matrix(0,nr=2,nc=n.iter)
ctr.x<-0
ctr.y<-0
samp[,1]=initial
for(i in 2:n.iter){
log.target1=function(x) log.w_den(x,samp[2,(i-1)])
res=geomc(log.target=log.target1, initial=samp[1,(i-1)],n.iter=1, mean.base = mean.base,var.base= var.base,dens.base=dens.base,samp.base=samp.base,mean.ap.tar=mean.ap.tar,var.ap.tar=var.ap.tar,dens.ap.tar=dens.ap.tar,samp.ap.tar=samp.ap.tar)
samp[1,i] =as.numeric(res$samples)
ctr.x<-ctr.x+res$acceptance.rate
log.target2=function(x) log.z_den(x,samp[1,i])
res=geomc(log.target=log.target2, initial=samp[2,(i-1)],n.iter=1, mean.base = mean.base,var.base= var.base,dens.base=dens.base,samp.base=samp.base,mean.ap.tar=mean.ap.tar,var.ap.tar=var.ap.tar,dens.ap.tar=dens.ap.tar,samp.ap.tar=samp.ap.tar)
samp[2,i] =as.numeric(res$samples)
ctr.y<-ctr.y+res$acceptance.rate
}
return(list(samples = samp, acceptance.rate.x = ctr.x/n.iter, acceptance.rate.y = ctr.y/n.iter))
}
set.seed(3)
res=geomc.gibbs(initial=c(.05,1.5),n.iter=100000) #works
saveRDS(res, file = "geomrwingibbs.rds")
res$acceptance.rate.x
res$acceptance.rate.y
rowMeans(res$samples)
multiESS(t(res$samples))
geommc:::msejd(res$samples)
mcse.multi(t(res$samples))
100000*(mcse(res$samples[1,])$se)^2
100000*(mcse(res$samples[2,])$se)^2
ess_indmh<-rep(0,2)
for (j in 1:2){
ess_indmh[j]<-ess(res$samples[j,])
}
acf_indmh<-matrix(0,nrow=10,ncol=2)
for (i in 1:2){
acf_indmh[,i]<-acf(res$samples[i,],plot=F,lag.max=10)$acf[-1]
}
ess_indmh
acf_indmh
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
pdf("six.marg.geomrwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
x.den=apply(outer(x,y,den), 1, mean)*2
y.den=apply(outer(x,y,den), 2, mean)
plot.dens.x=data.frame(x=seq(-4, 4, 0.1), x.den=x.den)
plot.dens.y=data.frame(y <- seq(-10, 10, 0.1), y.den=y.den)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
x.den=apply(outer(x,y,den), 1, mean)*2.5
y.den=apply(outer(x,y,den), 2, mean)
plot.dens.x=data.frame(x=seq(-4, 4, 0.1), x.den=x.den)
plot.dens.y=data.frame(y <- seq(-10, 10, 0.1), y.den=y.den)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
pdf("six.marg.geomrwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.5))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.2))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.4))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.15))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.15))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
pdf("six.marg.geomrwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.15))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
acf_indmh
mydata <- readRDS("rwingibbs.rds")
x.den=apply(outer(x,y,den), 1, mean)*2.5
y.den=apply(outer(x,y,den), 2, mean)
plot.dens.x=data.frame(x=seq(-4, 4, 0.1), x.den=x.den)
plot.dens.y=data.frame(y <- seq(-10, 10, 0.1), y.den=y.den)
pdf("six.marg.rwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = mydata$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = mydata$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.15))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
pdf("six.marg.rwingibbs.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = mydata$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = mydata$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
source('~/Box/adhya/gabesana/geomcmc/codes/subcodes/rw.R')
set.seed(3)
res<-rw_mc(3000,initial=c(.75,1.5),sig=0.01) ##does not work
set.seed(3)
res<-rw_mc(100000,initial=c(.75,1.5),sig=0.01) ##does not work
set.seed(3)
res<-rw_mc(100000,initial=c(.05,1.5),sig=0.01) ##does not work
saveRDS(res, file = "rw.rds")
res$acceptance.rate
rowMeans(res$samples)
multiESS(t(res$samples))
geommc:::msejd(res$samples)
mcse.multi(t(res$samples))
100000*(mcse(res$samples[1,])$se)^2
100000*(mcse(res$samples[2,])$se)^2
ess_indmh<-rep(0,2)
for (j in 1:2){
ess_indmh[j]<-ess(res$samples[j,])
}
acf_indmh<-matrix(0,nrow=10,ncol=2)
for (i in 1:2){
acf_indmh[,i]<-acf(res$samples[i,],plot=F,lag.max=10)$acf[-1]
}
ess_indmh
acf_indmh
x <- seq(-4, 4, 0.1)
y <- seq(-10, 10, 0.1)
x.den=apply(outer(x,y,den), 1, mean)*2.5
y.den=apply(outer(x,y,den), 2, mean)
plot.dens.x=data.frame(x=seq(-4, 4, 0.1), x.den=x.den)
plot.dens.y=data.frame(y <- seq(-10, 10, 0.1), y.den=y.den)
pdf("six.marg.rw.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
mean.base = function(x) x
var.b=0.01
var.base = function(x) diag(rep(var.b,2))
twopi=2*pi
dens.base=function(y,x) exp(-50*sum(y-x)^2)/twopi/var.b
samp.base=function(x) x+0.1*rnorm(2)
var.x=30^2
var.y=30^2
mean.ap.tar=function(x) c(0,0)
var.ap.tar=function(x) diag(c(var.x,var.y))
sq.x=sqrt(var.x)
sq.y=sqrt(var.y)
sq.det.sig=sq.x*sq.y
dens.ap.tar=function(y,x) exp(-0.5*sum(y^2)/var.x)/twopi/sq.det.sig
samp.ap.tar=function(x,kk) {return(diag(c(sq.x,sq.y))%*%rnorm(2))}
set.seed(3)
res=geomc(log.target=log.target, initial=c(.05,1.5),n.iter=100000, mean.base = mean.base,var.base= var.base,dens.base=dens.base,samp.base=samp.base,mean.ap.tar=mean.ap.tar,var.ap.tar=var.ap.tar,dens.ap.tar=dens.ap.tar,samp.ap.tar=samp.ap.tar)
saveRDS(res, file = "geomrw.rds")
res$acceptance.rate
rowMeans(res$samples)
multiESS(t(res$samples))
geommc:::msejd(res$samples)
mcse.multi(t(res$samples))
100000*(mcse(res$samples[1,])$se)^2
100000*(mcse(res$samples[2,])$se)^2
ess_indmh<-rep(0,2)
for (j in 1:2){
ess_indmh[j]<-ess(res$samples[j,])
}
acf_indmh<-matrix(0,nrow=10,ncol=2)
for (i in 1:2){
acf_indmh[,i]<-acf(res$samples[i,],plot=F,lag.max=10)$acf[-1]
}
ess_indmh
acf_indmh
pdf("six.marg.geomrw.pdf",onefile=FALSE,
width=8, height=3, pointsize=10)
grid.arrange(
ggplot() +
geom_line(data = plot.dens.x, aes(x = x, y = x.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[1,], y = ..density..),
binwidth = .3, fill = "red", alpha = 0.4, color = "black")+labs(x = "x", y = "")+scale_x_continuous(breaks=c(-4,0,4))+scale_y_continuous(breaks=c(0.0,0.3))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)),
ggplot() +
geom_line(data = plot.dens.y, aes(x = y, y = y.den),
color = "blue", size = 1) +
geom_histogram(aes(x = res$samples[2,], y = ..density..),
binwidth = .5, fill = "red", alpha = 0.4, color = "black") +
labs(x = "y", y = "")+scale_x_continuous(breaks=c(-10,-5,0,5,10))+scale_y_continuous(breaks=c(0.0,0.15))+theme(axis.text=element_text(size=24),axis.title=element_text(size=24)), nrow=1, ncol=2)
dev.off()
library(geommc)
log.target=function(y) dcauchy(y, log = TRUE)
geomc(log.target = log.target,n.iter = 5)
geomc(log.target = log.target,initial = 0,n.iter = 5)
?inherits
inherits(log.target,'function')
formals(log.target)
length(formals(log.target))
length("x")
log.target=function(y) -(y[1]^2+y[2]^2)/2
length(formals(log.target))
formals(log.target)
names(formals(log.target))
fn=function(x){return( exp(x)+2*x )}
fn(1)
checkFuncArgs <- function(func, args) {
if(!inherits(func, 'function')) {
return(FALSE)
}
func.args <- formals(func)
if(length(func.args) != length(args)) {
return(FALSE)
}
#  if(!all(names(func.args) == args)) {
#   return(FALSE)
# }
return(TRUE)
}
checkFuncArgs(log.target,"x")
checkFuncArgs <- function(func, args) {
if(!inherits(func, 'function')) {
return(FALSE)
}
func.args <- formals(func)
if(length(func.args) != length(args)) {
return(FALSE)
}
if(!all(names(func.args) == args)) {
return(FALSE)
}
return(TRUE)
}
checkFuncArgs(log.target,"x")
library(geommc)
remove.packages("geommc", lib="~/AppData/Local/R/win-library/4.4")
library(geommc)
remove.packages('geommc')
library(devtools)
devtools::load_all()
library(devtools)
load_all()
devtools::document()
devtools::check()
load_all()
devtools::document()
devtools::check()
?geomc.vs
?geomc
remove.packages("geommc", lib="~/AppData/Local/R/win-library/4.4")
